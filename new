#!/usr/local/bin/python3
import json
import csv
import sys

print("Starting")

read_path = sys.argv[1]
print(read_path)
write_path = read_path + '.csv'
print(write_path)


my_dict = []
csv_columns = []

with open(read_path, "r") as file:
    i = 0;
    for line in file:
        my_dict.append(dict(json.loads(line)))
        if my_dict[i].keys() not in csv_columns:
            for key in my_dict[i].keys():
                if key not in csv_columns:
                    csv_columns.append(key)
        i += 1;

with open(write_path, "w+") as csvfile:
    writer = csv.DictWriter(csvfile, fieldnames=csv_columns)
    writer.writeheader()
    for data in my_dict:
        writer.writerow(data)
    print("File successfully created under the name >> {}".format(write_path))

#
